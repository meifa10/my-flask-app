<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lupa Password - Pabrik Gula Pesantren Baru</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transition: background-image 1s ease-in-out;
    }

    .overlay {
      background-color: rgba(0, 0, 0, 0.5);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .form-container {
      width: 360px;
      padding: 25px 30px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
      text-align: center;
    }

    .form-container img {
      height: 60px;
      margin-bottom: 10px;
    }

    .form-container h2 {
      margin-bottom: 20px;
      font-weight: 600;
      color: #222;
    }

    label {
      display: block;
      text-align: left;
      margin-top: 10px;
      font-weight: 500;
    }

    .password-container {
      position: relative;
    }

    .password-container input {
      width: 100%;
      padding: 10px;
      padding-right: 40px;
      margin-top: 5px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }

    .toggle-password {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      cursor: pointer;
    }

    .toggle-password svg {
      width: 24px;
      height: 24px;
      fill: #333;
    }

    button {
      background-color: #121314;
      color: white;
      border: none;
      padding: 10px;
      width: 100%;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0051c8;
    }

    .flash-message {
      margin-top: 10px;
      font-size: 14px;
      padding: 0;
      list-style: none;
      text-align: left;
    }

    .flash.success {
      color: green;
    }

    .flash.error,
    .flash.danger {
      color: red;
    }

    .flash.warning {
      color: orange;
    }

    .back-link {
      margin-top: 10px;
      font-size: 14px;
    }

    .back-link a {
      color: #006aff;
      text-decoration: none;
    }

    .back-link a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="overlay">
    <div class="form-container">
      <img src="/static/image/logo.png" alt="Logo Sinergi Gula Nusantara">
      <h2>Reset Password</h2>

      <form method="POST">
        <label for="username">Username</label>
        <div class="password-container">
            <input type="text" id="username" name="username" required style="padding-right: 40px;">
        </div>


        <label for="new_password">Password Baru</label>
        <div class="password-container">
          <input type="password" id="new_password" name="new_password" required>
          <span class="toggle-password" onclick="togglePassword('new_password')">
            <svg id="eyeSlash_new_password" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M2.1 3.5L1 4.6l3.5 3.5C2.7 9.7 1.6 11.7 1 12c1.7 4.4 5.5 7.5 10 7.5 2.1 0 4-.6 5.7-1.7l3.6 3.6 1.1-1.1L2.1 3.5zM12 17.5c-3.1 0-5.8-2-7.3-5 0.5-1.1 1.3-2.2 2.3-3.1l2 2c-0.2 0.4-0.3 0.9-0.3 1.4a3.5 3.5 0 0 0 5 3.2l1.7 1.7c-1 0.5-2.1 0.8-3.4 0.8z"/>
            </svg>
            <svg id="eyeOpen_new_password" style="display:none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M12 4.5C7.5 4.5 3.7 7.6 2 12c1.7 4.4 5.5 7.5 10 7.5s8.3-3.1 10-7.5c-1.7-4.4-5.5-7.5-10-7.5zm0 13a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11zm0-9a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7z"/>
            </svg>
          </span>
        </div>

        <label for="confirm_password">Konfirmasi Password Baru</label>
        <div class="password-container">
          <input type="password" id="confirm_password" name="confirm_password" required>
          <span class="toggle-password" onclick="togglePassword('confirm_password')">
            <svg id="eyeSlash_confirm_password" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M2.1 3.5L1 4.6l3.5 3.5C2.7 9.7 1.6 11.7 1 12c1.7 4.4 5.5 7.5 10 7.5 2.1 0 4-.6 5.7-1.7l3.6 3.6 1.1-1.1L2.1 3.5zM12 17.5c-3.1 0-5.8-2-7.3-5 0.5-1.1 1.3-2.2 2.3-3.1l2 2c-0.2 0.4-0.3 0.9-0.3 1.4a3.5 3.5 0 0 0 5 3.2l1.7 1.7c-1 0.5-2.1 0.8-3.4 0.8z"/>
            </svg>
            <svg id="eyeOpen_confirm_password" style="display:none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M12 4.5C7.5 4.5 3.7 7.6 2 12c1.7 4.4 5.5 7.5 10 7.5s8.3-3.1 10-7.5c-1.7-4.4-5.5-7.5-10-7.5zm0 13a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11zm0-9a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7z"/>
            </svg>
          </span>
        </div>

        <button type="submit">Simpan Password Baru</button>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <ul class="flash-message">
              {% for category, message in messages %}
                <li class="flash {{ category }}">{{ message }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}
      </form>

      <div class="back-link">
        <a href="{{ url_for('auth.login') }}">‚Üê Kembali ke Login</a>
      </div>
    </div>
  </div>

  <script>
    const images = [
      '/static/image/pgpesantren.jpg',
      '/static/image/pgpb.jpg',
      '/static/image/pgpb2.jpg'
    ];
    let index = 0;
    function changeBackground() {
      document.body.style.backgroundImage = `url('${images[index]}')`;
      index = (index + 1) % images.length;
    }
    changeBackground();
    setInterval(changeBackground, 5000);

    function togglePassword(fieldId) {
      const input = document.getElementById(fieldId);
      const eyeOpen = document.getElementById("eyeOpen_" + fieldId);
      const eyeSlash = document.getElementById("eyeSlash_" + fieldId);

      if (input.type === "password") {
        input.type = "text";
        eyeOpen.style.display = "inline";
        eyeSlash.style.display = "none";
      } else {
        input.type = "password";
        eyeOpen.style.display = "none";
        eyeSlash.style.display = "inline";
      }
    }
  </script>
</body>
</html>
